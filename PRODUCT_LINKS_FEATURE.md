# ميزة روابط المنتجات (Product Links Feature)

## نظرة عامة

تم تطوير ميزة **روابط المنتجات** لتمكين المديرين من إضافة روابط مفيدة متعلقة بكل منتج، وعرضها للعملاء في صفحة تفاصيل المنتج.

---

## الملفات المُضافة/المُحدثة

### 1. قاعدة البيانات
- **Migration**: `database/migrations/2025_08_24_121713_create_product_links_table.php`
  - جدول `product_links` مع الحقول: id, product_id, url, caption, description, timestamps

### 2. النماذج (Models)
- **ProductLink Model**: `app/Models/ProductLink.php`
  - علاقة `belongsTo` مع Product
  - validation للـ URL
  - تنسيق تلقائي للـ URLs

- **Product Model**: `app/Models/Product.php` (مُحدث)
  - علاقة `hasMany` مع ProductLink
  - تحميل الروابط في صفحة التفاصيل

### 3. مكون Livewire للإدارة
- **Component**: `app/Livewire/Admin/ProductLinksManager.php`
- **View**: `resources/views/livewire/admin/product-links-manager.blade.php`

### 4. تحديثات لوحة الإدارة
- **ProductController**: `app/Http/Controllers/Admin/ProductController.php`
- **Create Form**: `resources/views/admin/products/create.blade.php`
- **Edit Form**: `resources/views/admin/products/edit.blade.php`

### 5. الواجهة الأمامية
- **Product Details**: `resources/views/products/show.blade.php`
- **ProductController**: `app/Http/Controllers/ProductController.php`

### 6. التصميم والأنماط
- **CSS**: `public/assets/css/admin/product-links.css`

---

## كيفية الاستخدام

### للمديرين:

#### إضافة روابط عند إنشاء منتج جديد:
1. اذهب إلى لوحة الإدارة → المنتجات → إضافة منتج جديد
2. املأ بيانات المنتج الأساسية
3. انتقل إلى قسم **"روابط المنتج"**
4. أضف روابط مفيدة:
   - **الرابط (URL)**: الرابط الكامل (مثل: https://example.com)
   - **العنوان**: عنوان وصفي للرابط
   - **الوصف**: وصف اختياري للرابط
5. استخدم زر **"إضافة رابط جديد"** لإضافة المزيد
6. احفظ المنتج

#### تعديل روابط منتج موجود:
1. اذهب إلى لوحة الإدارة → المنتجات
2. اختر **"تعديل"** للمنتج المطلوب
3. انتقل إلى قسم **"روابط المنتج"**
4. عدّل الروابط الموجودة أو أضف روابط جديدة
5. احفظ التغييرات

### للعملاء:

سيرى العملاء قسم **"روابط مفيدة"** في صفحة تفاصيل المنتج (إذا كانت هناك روابط مضافة):
- الروابط تظهر كبطاقات منسقة
- كل رابط يفتح في نافذة جديدة
- تصميم متجاوب يعمل على جميع الأجهزة

---

## الميزات المتقدمة

### 1. التحقق التلقائي من URLs:
- إضافة `https://` تلقائياً إذا لم يكن موجوداً
- التحقق من صحة تنسيق الرابط

### 2. معاينة الروابط:
- معاينة فورية للرابط أثناء الإدخال
- عرض الشكل النهائي قبل الحفظ

### 3. التصميم التفاعلي:
- تأثيرات بصرية عند التمرير
- رسوم متحركة سلسة
- تصميم متجاوب

### 4. إدارة متقدمة:
- إضافة/حذف روابط ديناميكياً
- التحقق من البيانات في الوقت الفعلي
- حفظ آمن مع معالجة الأخطاء

---

## هيكل قاعدة البيانات

```sql
CREATE TABLE product_links (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    product_id BIGINT UNSIGNED NOT NULL,
    url VARCHAR(255) NOT NULL,
    caption VARCHAR(255) NOT NULL,
    description TEXT NULL,
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    INDEX idx_product_id (product_id),
    FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE CASCADE
);
```

---

## أمثلة على الاستخدام

### مثال 1: منتج طبي
```
العنوان: "دليل الاستخدام الطبي"
الرابط: https://medical-guide.com/product-123
الوصف: "دليل شامل لاستخدام هذا المنتج في العيادات"
```

### مثال 2: فيديو توضيحي
```
العنوان: "فيديو تعليمي"
الرابط: https://youtube.com/watch?v=abc123
الوصف: "فيديو يوضح طريقة الاستخدام الصحيحة خطوة بخطوة"
```

### مثال 3: شهادات الجودة
```
العنوان: "شهادة ISO"
الرابط: https://certificates.com/iso-cert.pdf
الوصف: "شهادة الجودة والمطابقة للمعايير الدولية"
```

---

## الحماية والأمان

1. **التحقق من البيانات**: جميع البيانات تخضع للتحقق قبل الحفظ
2. **حماية من XSS**: استخدام `{!! !!}` بحذر وتنظيف البيانات
3. **الروابط الخارجية**: تفتح في نوافذ جديدة مع `rel="noopener noreferrer"`
4. **الصلاحيات**: فقط المديرون يمكنهم إدارة الروابط

---

## التخصيص والتطوير

### إضافة أنواع روابط جديدة:
يمكن تطوير النظام لدعم أنواع مختلفة من الروابط (فيديوهات، PDFs، صور، إلخ) عبر:
1. إضافة حقل `type` في جدول `product_links`
2. إنشاء أيقونات مختلفة لكل نوع
3. تخصيص طريقة العرض حسب النوع

### إضافة ترتيب الروابط:
1. إضافة حقل `sort_order` في الجدول
2. تحديث Livewire Component لدعم السحب والإفلات
3. عرض الروابط مرتبة حسب الأولوية

---

## استكشاف الأخطاء

### مشكلة: الروابط لا تظهر في الواجهة الأمامية
**الحل**: تأكد من:
- تحميل علاقة `links` في ProductController
- وجود روابط مضافة للمنتج
- عدم وجود أخطاء في ملف CSS

### مشكلة: خطأ عند حفظ الروابط
**الحل**: تأكد من:
- صحة تنسيق JSON المرسل
- صحة البيانات المدخلة
- وجود صلاحيات كافية

### مشكلة: الروابط لا تفتح بشكل صحيح
**الحل**: تأكد من:
- إضافة `https://` للروابط
- عدم وجود مسافات في الرابط
- صحة الرابط المدخل

---

## الدعم والصيانة

- تحديث منتظم لمكتبات CSS/JS
- مراقبة أداء قاعدة البيانات
- اختبار دوري للروابط المضافة
- تدريب فريق الإدارة على الاستخدام

---

✅ **تم تطبيق الميزة بنجاح مع جميع المتطلبات المطلوبة!**
